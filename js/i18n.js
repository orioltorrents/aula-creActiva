/**
 * Sistema d'Internacionalització (i18n)
 * Suport per a: Català (ca), Castellà (es), Anglès (en), Àrab (ar)
 */

const i18n = {
    currentLang: 'ca', // Idioma per defecte

    // Diccionari de textos comuns
    translations: {
        'ca': {
            'btn_practice': 'Pràctica',
            'btn_exam': 'Examen',
            'btn_start': 'Començar',
            'btn_next': 'Següent',
            'btn_finish': 'Finalitzar',
            'score': 'Puntuació',
            'correct': 'Correcte!',
            'incorrect': 'Incorrecte.',
            'time': 'Temps',
            'loading': 'Carregant...',
            'result_saved': 'Resultat guardat correctament!',
            'result_error': 'Error al guardar el resultat.',
            'select_answer': 'Selecciona la resposta correcta:',
            'final_score': 'Puntuació Final',
            'mode_practice_desc': 'Practica sense límit de temps i amb feedback immediat. Els resultats no es guarden.',
            'mode_exam_desc': 'Posa a prova els teus coneixements. Els resultats es guardaran al teu expedient.',
            'language': 'Idioma',
            'choose_lang': 'Tria el teu idioma',
            'active_projects': 'Aquests són els teus projectes actius.',
            'hide_country': 'Amagar País',
            'show_country': 'Mostrar País',
            'act_map_title': 'Mapa del Mediterrani',
            'act_map_desc': 'Identifica els països al mapa',
            'no_projects': 'No tens projectes assignats o no s\'han pogut carregar.',
            'med_project_title': 'Projecte Mediterrani',
            'act_capitals_title': 'Capitals',
            'act_capitals_desc': 'Aprèn les capitals del Mediterrani',
            'act_sea_title': 'El Mar del Mig',
            'act_sea_desc': 'Vídeo i Test de coneixements',
            'btn_start_test': 'Començar Test',
            'par_project_title': 'Projecte Paralímpics',
            'act_microbit_title': 'Control de la Micro:bit',
            'act_microbit_desc': 'Demostra què saps sobre la placa',
            'btn_start': 'Començar',
            'level_easy': 'Fàcil',
            'level_medium': 'Mitjà',
            'level_hard': 'Difícil',
            'level_mixed': 'Barrejat',
            'login_title': 'Aula CreActiva',
            'login_subtitle': 'Accés a l\'Entorn d\'Aprenentatge',
            'label_email': 'Correu electrònic',
            'label_password': 'Contrasenya',
            'btn_login': 'Entrar',
            'hi': 'Hola',
            'logout': 'Sortir',
            'back': 'Tornar',
            'loading_projects': 'Carregant projectes...',
            'no_projects': 'No tens projectes assignats o no s\'han pogut carregar.',
            'natura_project_title': 'Entorns de Natura',
            'act_xarxes_title': 'Xarxes Tròfiques',
            'act_xarxes_desc': 'Ordena els passos per crear una xarxa tròfica',
            'instruction_xarxes': 'Ordena aquestes accions per establir una xarxa tròfica amb dades reals:',
            'action_select_ecosystem': 'Seleccionar l\'ecosistema d\'estudi',
            'action_identify_species': 'Identificar les espècies presents',
            'action_observe_behavior': 'Observar el comportament directament',
            'action_collect_samples': 'Recollir mostres (excrements o egagròpiles)',
            'action_scientific_info': 'Cercar informació científica',
            'action_diet_classification': 'Classificar per règim alimentari',
            'action_primary_producers': 'Identificar els productors primaris',
            'action_assign_trophic_level': 'Assignar el nivell tròfic',
            'action_draw_interactions': 'Dibuixar les fletxes d\'interacció',
            'action_final_web': 'Construir la xarxa tròfica final',
            'btn_verify': 'Verificar Ordenació',
            'result_order': 'Accions ben ordenades:',
            'act_rols_title': 'Classificació de rols tròfics',
            'act_rols_desc': 'Classifica espècies segons la seva dieta i nivell tròfic',
            'choose_ecosystem': 'Tria un ecosistema per començar',
            'regime': 'Règim alimentari',
            'trophic_level': 'Nivell tròfic',
            'justification': 'Justificació científica',
            'justification_ph': 'Explica per què has triat aquestes opcions (mínim 10 caràcters)...',
            'btn_send_answer': 'Enviar resposta',
            'btn_next_question': 'Següent pregunta',
            'score_regime': 'Punts Règim',
            'score_level': 'Punts Nivell',
            'score_just': 'Punts Justificació',
            'total_score': 'Punts Totals',
            'final_message_apprentice': 'Ets un Aprenent. Cal seguir practicant!',
            'final_message_analyst': 'Ets un Analista. Molt bona feina!',
            'final_message_expert': 'Ets un Expert! Tens un domini total.',
            'mode_practice': 'Mode Pràctica',
            'mode_exam': 'Mode Avaluació',
            'herbivore': 'Herbívor',
            'carnivore': 'Carnívor',
            'omnivore': 'Omnívor',
            'decomposer': 'Descomponedor',
            'autotroph': 'Autòtrof',
            'producer': 'Productor',
            'primary_consumer': 'Consumidor Primari',
            'secondary_consumer': 'Consumidor Secundari',
            'tertiary_consumer': 'Consumidor Terciari',
            'eco_forest': 'Bosc mediterrani',
            'eco_sea': 'Mar mediterrani',
            'eco_river': 'Riu mediterrani',
            'eco_garden': 'Hort'
        },
        'es': {
            'btn_practice': 'Práctica',
            'btn_exam': 'Examen',
            'btn_start': 'Empezar',
            'btn_next': 'Siguiente',
            'btn_finish': 'Finalizar',
            'score': 'Puntuación',
            'correct': '¡Correcto!',
            'incorrect': 'Incorrecto.',
            'time': 'Tiempo',
            'loading': 'Cargando...',
            'result_saved': '¡Resultado guardado correctamente!',
            'result_error': 'Error al guardar el resultado.',
            'select_answer': 'Selecciona la respuesta correcta:',
            'final_score': 'Puntuación Final',
            'mode_practice_desc': 'Practica sin límite de tiempo y con feedback inmediato. Los resultados no se guardan.',
            'mode_exam_desc': 'Pon a prueba tus conocimientos. Los resultados se guardarán en tu expediente.',
            'language': 'Idioma',
            'choose_lang': 'Elige tu idioma',
            'active_projects': 'Estos son tus proyectos activos.',
            'hide_country': 'Ocultar País',
            'show_country': 'Mostrar País',
            'act_map_title': 'Mapa del Mediterráneo',
            'act_map_desc': 'Identifica los países en el mapa',
            'no_projects': 'No tienes proyectos asignados o no se han podido cargar.',
            'med_project_title': 'Proyecto Mediterráneo',
            'act_capitals_title': 'Capitales',
            'act_capitals_desc': 'Aprende las capitales del Mediterráneo',
            'act_sea_title': 'El Mar del Medio',
            'act_sea_desc': 'Vídeo y Test de conocimientos',
            'btn_start_test': 'Empezar Test',
            'par_project_title': 'Proyecto Paralímpicos',
            'act_microbit_title': 'Control de la Micro:bit',
            'act_microbit_desc': 'Demuestra qué sabes sobre la placa',
            'btn_start': 'Comenzar',
            'level_easy': 'Fácil',
            'level_medium': 'Medio',
            'level_hard': 'Difícil',
            'level_mixed': 'Mezclado',
            'login_title': 'Aula CreActiva',
            'login_subtitle': 'Acceso al Entorno de Aprendizaje',
            'label_email': 'Correo electrónico',
            'label_password': 'Contraseña',
            'btn_login': 'Entrar',
            'hi': 'Hola',
            'logout': 'Salir',
            'back': 'Volver',
            'loading_projects': 'Cargando proyectos...',
            'no_projects': 'No tienes proyectos asignados o no se han podido cargar.',
            'natura_project_title': 'Entornos de Naturaleza',
            'act_xarxes_title': 'Redes Tróficas',
            'act_xarxes_desc': 'Ordena los pasos para crear una red trófica',
            'instruction_xarxes': 'Ordena estas acciones para establecer una red trófica con datos reales:',
            'action_select_ecosystem': 'Seleccionar el ecosistema de estudio',
            'action_identify_species': 'Identificar las especies presentes',
            'action_observe_behavior': 'Observar el comportamiento directamente',
            'action_collect_samples': 'Recoger muestras (excrementos o egagrópilas)',
            'action_scientific_info': 'Buscar información científica',
            'action_diet_classification': 'Clasificar por régimen alimenticio',
            'action_primary_producers': 'Identificar los productores primarios',
            'action_assign_trophic_level': 'Asignar el nivel trófico',
            'action_draw_interactions': 'Dibujar las flechas de interacción',
            'action_final_web': 'Construir la red trófica final',
            'btn_verify': 'Verificar Ordenación',
            'result_order': 'Acciones bien ordenadas:',
            'act_rols_title': 'Clasificación de roles tróficos',
            'act_rols_desc': 'Clasifica especies según su dieta y nivel trófico',
            'choose_ecosystem': 'Elige un ecosistema para empezar',
            'regime': 'Régimen alimenticio',
            'trophic_level': 'Nivel trófico',
            'justification': 'Justificación científica',
            'justification_ph': 'Explica por qué has elegido estas opciones (mínimo 10 caracteres)...',
            'btn_send_answer': 'Enviar respuesta',
            'btn_next_question': 'Siguiente pregunta',
            'score_regime': 'Puntos Régimen',
            'score_level': 'Puntos Nivel',
            'score_just': 'Puntos Justificación',
            'total_score': 'Puntos Totales',
            'final_message_apprentice': 'Eres un Aprendiz. ¡Sigue practicando!',
            'final_message_analyst': 'Eres un Analista. ¡Muy buen trabajo!',
            'final_message_expert': '¡Eres un Experto! Tienes un dominio total.',
            'mode_practice': 'Modo Práctica',
            'mode_exam': 'Modo Evaluación',
            'herbivore': 'Herbívoro',
            'carnivore': 'Carnívoro',
            'omnivore': 'Omnívoro',
            'decomposer': 'Descomponedor',
            'autotroph': 'Autótrofo',
            'producer': 'Productor',
            'primary_consumer': 'Consumidor Primario',
            'secondary_consumer': 'Consumidor Secundario',
            'tertiary_consumer': 'Consumidor Terciario',
            'eco_forest': 'Bosque mediterráneo',
            'eco_sea': 'Mar mediterráneo',
            'eco_river': 'Río mediterráneo',
            'eco_garden': 'Huerto'
        },
        'en': {
            'btn_practice': 'Practice',
            'btn_exam': 'Exam',
            'btn_start': 'Start',
            'btn_next': 'Next',
            'btn_finish': 'Finish',
            'score': 'Score',
            'correct': 'Correct!',
            'incorrect': 'Incorrect.',
            'time': 'Time',
            'loading': 'Loading...',
            'result_saved': 'Result saved successfully!',
            'result_error': 'Error saving result.',
            'select_answer': 'Select the correct answer:',
            'final_score': 'Final Score',
            'mode_practice_desc': 'Practice without time limit and with immediate feedback. Results are not saved.',
            'mode_exam_desc': 'Test your knowledge. Results will be saved to your record.',
            'language': 'Language',
            'choose_lang': 'Choose your language',
            'active_projects': 'These are your active projects.',
            'hide_country': 'Hide Country',
            'show_country': 'Show Country',
            'act_map_title': 'Mediterranean Map',
            'act_map_desc': 'Identify countries on the map',
            'no_projects': 'You have no assigned projects or they could not be loaded.',
            'med_project_title': 'Mediterranean Project',
            'act_capitals_title': 'Capitals',
            'act_capitals_desc': 'Learn the capitals of the Mediterranean',
            'act_sea_title': 'The Middle Sea',
            'act_sea_desc': 'Video and Knowledge Test',
            'btn_start_test': 'Start Test',
            'par_project_title': 'Paralympics Project',
            'act_microbit_title': 'Micro:bit Control',
            'act_microbit_desc': 'Show what you know about the board',
            'btn_start': 'Start',
            'level_easy': 'Easy',
            'level_medium': 'Medium',
            'level_hard': 'Hard',
            'level_mixed': 'Mixed',
            'login_title': 'Aula CreActiva',
            'login_subtitle': 'Learning Environment Access',
            'label_email': 'Email address',
            'label_password': 'Password',
            'btn_login': 'Login',
            'hi': 'Hello',
            'logout': 'Logout',
            'back': 'Back',
            'loading_projects': 'Loading projects...',
            'no_projects': 'You have no assigned projects or they could not be loaded.',
            'natura_project_title': 'Nature Environments',
            'act_xarxes_title': 'Trophic Networks',
            'act_xarxes_desc': 'Order the steps to create a trophic network',
            'instruction_xarxes': 'Order these actions to establish a trophic network with real data:',
            'action_select_ecosystem': 'Select the study ecosystem',
            'action_identify_species': 'Identify the species present',
            'action_observe_behavior': 'Observe behavior directly',
            'action_collect_samples': 'Collect samples (excrement or pellets)',
            'action_scientific_info': 'Search for scientific information',
            'action_diet_classification': 'Classify by diet',
            'action_primary_producers': 'Identify primary producers',
            'action_assign_trophic_level': 'Assign the trophic level',
            'action_draw_interactions': 'Draw interaction arrows',
            'action_final_web': 'Build the final trophic web',
            'btn_verify': 'Verify Ordering',
            'result_order': 'Correctly ordered actions:',
            'act_rols_title': 'Trophic Roles Classification',
            'act_rols_desc': 'Classify species by their diet and trophic level',
            'choose_ecosystem': 'Choose an ecosystem to start',
            'regime': 'Dietary regime',
            'trophic_level': 'Trophic level',
            'justification': 'Scientific justification',
            'justification_ph': 'Explain why you chose these options (min 10 characters)...',
            'btn_send_answer': 'Send answer',
            'btn_next_question': 'Next question',
            'score_regime': 'Regime Points',
            'score_level': 'Level Points',
            'score_just': 'Justification Points',
            'total_score': 'Total Points',
            'final_message_apprentice': 'You are an Apprentice. Keep practicing!',
            'final_message_analyst': 'You are an Analyst. Great job!',
            'final_message_expert': 'You are an Expert! You have total mastery.',
            'mode_practice': 'Practice Mode',
            'mode_exam': 'Evaluation Mode',
            'herbivore': 'Herbivore',
            'carnivore': 'Carnivore',
            'omnivore': 'Omnivore',
            'decomposer': 'Decomposer',
            'autotroph': 'Autotroph',
            'producer': 'Producer',
            'primary_consumer': 'Primary Consumer',
            'secondary_consumer': 'Secondary Consumer',
            'tertiary_consumer': 'Tertiary Consumer',
            'eco_forest': 'Mediterranean Forest',
            'eco_sea': 'Mediterranean Sea',
            'eco_river': 'Mediterranean River',
            'eco_garden': 'Garden'
        },
        'ar': {
            'btn_practice': 'ممارسة',
            'btn_exam': 'امتحان',
            'btn_start': 'ابدأ',
            'btn_next': 'التالي',
            'btn_finish': 'إنهاء',
            'score': 'النتيجة',
            'correct': 'صحيح!',
            'incorrect': 'خطأ.',
            'time': 'الوقت',
            'loading': 'جار التحميل...',
            'result_saved': 'تم حفظ النتيجة بنجاح!',
            'result_error': 'خطأ في حفظ النتيجة.',
            'select_answer': 'اختر الإجابة الصحيحة:',
            'final_score': 'النتيجة النهائية',
            'mode_practice_desc': 'مارس بدون حد زمني ومع تعليقات فورية. لا يتم حفظ النتائج.',
            'mode_exam_desc': 'اختبر معلوماتك. سيتم حفظ النتائج في سجلك.',
            'language': 'لغة',
            'choose_lang': 'اختر لغتك',
            'active_projects': 'هذه هي مشاريعك النشطة.',
            'hide_country': 'إخفاء البلد',
            'show_country': 'إظهار البلد',
            'act_map_title': 'خريطة البحر الأبيض المتوسط',
            'act_map_desc': 'تحديد البلدان على الخريطة',
            'no_projects': 'ليس لديك مشاريع معينة أو لم يتم تحميلها.',
            'med_project_title': 'مشروع البحر الأبيض المتوسط',
            'act_capitals_title': 'العواصم',
            'act_capitals_desc': 'تعلم عواصم البحر الأبيض المتوسط',
            'act_sea_title': 'البحر الأوسط',
            'act_sea_desc': 'فيديو واختبار المعلومات',
            'btn_start_test': 'ابدأ الاختبار',
            'par_project_title': 'مشروع بارالمبيك',
            'act_microbit_title': 'التحكم في Micro:bit',
            'act_microbit_desc': 'أظهر ما تعرفه عن اللوحة',
            'btn_start': 'ابدأ',
            'level_easy': 'سهل',
            'level_medium': 'متوسط',
            'level_hard': 'صعب',
            'level_mixed': 'مختلط',
            'login_title': 'أولا كرياكتيفا',
            'login_subtitle': 'الوصول إلى بيئة التعلم',
            'label_email': 'البريد الإلكتروني',
            'label_password': 'كلمة المرور',
            'btn_login': 'تسجيل الدخول',
            'hi': 'مرحباً',
            'logout': 'تسجيل الخروج',
            'back': 'رجوع',
            'loading_projects': 'جارٍ تحميل المشاريع...',
            'no_projects': 'ليس لديك مشاريع معينة أو لم يتم تحميلها.',
            'natura_project_title': 'بيئات الطبيعة',
            'act_xarxes_title': 'الشبكات الغذائية',
            'act_xarxes_desc': 'رتب الخطوات لإنشاء شبكة غذائية',
            'instruction_xarxes': 'رتب هذه الإجراءات لإنشاء شبكة غذائية ببيانات حقيقية:',
            'action_select_ecosystem': 'اختيار النظام البيئي للدراسة',
            'action_identify_species': 'تحديد الأنواع الموجودة',
            'action_observe_behavior': 'ملاحظة السلوك مباشرة',
            'action_collect_samples': 'جمع العينات (الفضلات أو الكريات)',
            'action_scientific_info': 'البحث عن معلومات علمية',
            'action_diet_classification': 'التصنيف حسب النظام الغذائي',
            'action_primary_producers': 'تحديد المنتجين الأساسيين',
            'action_assign_trophic_level': 'تعيين المستوى الغذائي',
            'action_draw_interactions': 'رسم أسهم التفاعل',
            'action_final_web': 'بناء الشبكة الغذائية النهائية',
            'btn_verify': 'التحقق من الترتيب',
            'result_order': 'الإجراءات المرتبة بشكل صحيح:',
            'act_rols_title': 'تصنيف الأدوار الغذائية',
            'act_rols_desc': 'تصنيف الأنواع حسب نظامها الغذائي ومستواها الغذائي',
            'choose_ecosystem': 'اختر نظامًا بيئيًا للبدء',
            'regime': 'النظام الغذائي',
            'trophic_level': 'المستوى الغذائي',
            'justification': 'التبرير العلمي',
            'justification_ph': 'اشرح سبب اختيارك لهذه الخيارات (10 أحرف كحد أدنى)...',
            'btn_send_answer': 'إرسال الإجابة',
            'btn_next_question': 'السؤال التالي',
            'score_regime': 'نقاط النظام',
            'score_level': 'نقاط المستوى',
            'score_just': 'نقاط التبرير',
            'total_score': 'إجمالي النقاط',
            'final_message_apprentice': 'أنت مبتدئ. استمر في التدريب!',
            'final_message_analyst': 'أنت محلل. عمل رائع!',
            'final_message_expert': 'أنت خبير! لديك سيطرة كاملة.',
            'mode_practice': 'وضع التدريب',
            'mode_exam': 'وضع التقييم',
            'herbivore': 'عاشب',
            'carnivore': 'لاحم',
            'omnivore': 'قارت',
            'decomposer': 'محلل',
            'autotroph': 'ذاتي التغذية',
            'producer': 'منتج',
            'primary_consumer': 'مستهلك أول',
            'secondary_consumer': 'مستهلك ثانٍ',
            'tertiary_consumer': 'مستهلك ثالث',
            'eco_forest': 'غابة متوسطية',
            'eco_sea': 'بحر متوسطي',
            'eco_river': 'نهر متوسطي',
            'eco_garden': 'بستان'
        }
    },

    // Funció per canviar l'idioma
    setLanguage: function (lang) {
        if (this.translations[lang]) {
            this.currentLang = lang;

            // Actualitzar direcció del text per a Àrab
            if (lang === 'ar') {
                document.body.setAttribute('dir', 'rtl');
                document.body.classList.add('rtl');
            } else {
                document.body.setAttribute('dir', 'ltr');
                document.body.classList.remove('rtl');
            }

            // Disparar esdeveniment de canvi d'idioma per a que els jocs s'actualitzin
            document.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang: lang } }));

            console.log('Idioma canviat a:', lang);
        }
    },

    // Funció per obtenir una traducció
    t: function (key) {
        const text = this.translations[this.currentLang][key];
        return text || key; // Si no troba la clau, retorna la clau mateixa
    }
};
